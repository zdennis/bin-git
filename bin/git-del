#!/usr/bin/env bash

VERSION="1.0.0"
SCRIPT_NAME="git-del"

show_help() {
  cat << EOF
$SCRIPT_NAME - Stage deleted files for commit

Usage: $SCRIPT_NAME [options]

Options:
  -h, --help     Show this help message
  -v, --version  Show version information

Description:
  Automatically runs 'git rm' on files that have been deleted from the
  working directory so git knows to track their deletion.

Examples:
  # Stage all deleted files
  rm file1.txt file2.txt
  $SCRIPT_NAME
  git commit -m "Remove files"

Version: $VERSION
EOF
}

case "$1" in
  -h|--help)
    show_help
    exit 0
    ;;
  -v|--version)
    echo "$SCRIPT_NAME version $VERSION"
    exit 0
    ;;
esac

# Find deleted files and stage them
deleted_files=$(git status --porcelain 2>/dev/null | grep "^ D" | cut -c4-)
if [ -z "$deleted_files" ]; then
  echo "No deleted files to stage"
  exit 0
fi

echo "$deleted_files" | while read -r file; do
  git rm "$file" 2>/dev/null
done
